! $Id:$
! $Date:$
! $Revision:$
no ip access-list extended snmpacl
ip access-list extended snmpacl
 remark $Id:$
 remark Denies all traffic to internal IPs except established tcp replies.
 remark Also denies access to certain public allocations.
 remark Ideal for some internal lab/testing types of subnets that are
 remark not well trusted, but allowing internal users to access.
 remark Apply to ingress interface (to filter traffic coming from lab)


 remark deny-from-bogons
 deny ip 0.0.0.0 0.255.255.255 any
 deny ip 192.0.0.0 0.0.0.255 any
 deny ip 192.0.2.0 0.0.0.255 any
 deny ip 198.18.0.0 0.1.255.255 any
 deny ip 198.51.100.0 0.0.0.255 any
 deny ip 203.0.113.0 0.0.0.255 any
 deny ip 224.0.0.0 15.255.255.255 any
 deny ip 240.0.0.0 15.255.255.255 any


 remark deny-from-reserved
 deny ip 0.0.0.0 0.255.255.255 any
 deny ip 10.0.0.0 0.255.255.255 any
 deny ip 100.64.0.0 0.63.255.255 any
 deny ip 127.0.0.0 0.255.255.255 any
 deny ip 169.254.0.0 0.0.255.255 any
 deny ip 172.16.0.0 0.15.255.255 any
 deny ip 192.168.0.0 0.0.255.255 any
 deny ip 224.0.0.0 15.255.255.255 any
 deny ip 240.0.0.0 15.255.255.255 any


 remark deny-to-rfc1918
 deny ip any 10.0.0.0 0.255.255.255
 deny ip any 172.16.0.0 0.15.255.255
 deny ip any 192.168.0.0 0.0.255.255


 remark accept-dhcp
 remark Optional - allow forwarding of DHCP requests.
 permit udp any any eq 67
 permit udp any any eq 68


 remark accept-to-honestdns
 remark Allow name resolution using honestdns.
 permit udp any host 8.8.4.4 eq 53
 permit udp any host 8.8.8.8 eq 53


 remark accept-tcp-replies
 remark Allow tcp replies to internal hosts.
 permit tcp any 10.0.0.0 0.255.255.255 established
 permit tcp any 172.16.0.0 0.15.255.255 established
 permit tcp any 192.168.0.0 0.0.255.255 established


 remark deny-to-internal
 remark Deny access to rfc1918/internal.
 deny ip any 10.0.0.0 0.255.255.255
 deny ip any 172.16.0.0 0.15.255.255
 deny ip any 192.168.0.0 0.0.255.255


 remark allow-to-specific_hosts
 remark Accept access to specified public.
 permit ip any host 200.1.1.1
 permit ip any host 200.1.1.2
 permit ip any host 200.1.1.4
 permit ip any host 200.1.1.5


 remark default-permit
 remark Allow what's left.
 permit ip any any

exit
